<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Boss Respawn Timer</title>

<style>
body {
  font-family: Arial, sans-serif;
  background: #111;
  color: #eee;
  padding: 20px;
}

h1 {
  text-align: center;
}

.boss {
  background: #222;
  border-radius: 8px;
  padding: 15px;
  margin: 15px auto;
  max-width: 600px;
}

.timer {
  margin-top: 10px;
  font-weight: bold;
}

.spawned { color: #4caf50; }
.soon { color: #ffc107; }
.wait { color: #f44336; }

button {
  margin-top: 8px;
  margin-right: 5px;
  padding: 6px 10px;
  cursor: pointer;
}
</style>
</head>

<body>

<h1>Boss Respawn Timer</h1>
<div id="bossList"></div>

<script>
// ================== ADMIN MODE ==================
const isAdmin = new URLSearchParams(window.location.search).get("admin") === "1";

// ================== BOSS CONFIG ==================
const bosses = [
  { name: "Venatus", level: 60, location: "Corrupted River Stream", respawnHours: 10 },
  { name: "Viorent", level: 65, location: "Gill Stream", respawnHours: 10 },
  { name: "Ego", level: 70, location: "Reclaimed Gathering Point", respawnHours: 21 },
  { name: "Livera", level: 75, location: "Black Storm Peninsula", respawnHours: 24 },
  { name: "Araneo", level: 75, location: "Lower Tomb of Tyriosa 1F", respawnHours: 24 },
  { name: "Undomiel", level: 80, location: "Test Subject Lab", respawnHours: 24 },
  { name: "Lady Dalia", level: 85, location: "Bloody Shadow", respawnHours: 18 },
  { name: "General Aquleus", level: 85, location: "Lower Tomb of Tyriosa 2F", respawnHours: 29 },
  { name: "Amentis", level: 88, location: "Limestone Cape", respawnHours: 29 },
  { name: "Baron Braudmore", level: 88, location: "Rosevine Bridge", respawnHours: 32 }
];

// ================== STORAGE ==================
let bossData = JSON.parse(localStorage.getItem("bossData") || "{}");

function saveData() {
  localStorage.setItem("bossData", JSON.stringify(bossData));
}

// ================== TIMER LOGIC ==================
function markKilled(boss) {
  bossData[boss.name] = Date.now() + boss.respawnHours * 3600000;
  saveData();
}

function resetBoss(name) {
  delete bossData[name];
  saveData();
}

function getRemaining(ts) {
  if (!ts) return null;
  return ts - Date.now();
}

function formatTime(ms) {
  if (ms <= 0) return "SPAWNED / CHECK NOW";
  const h = Math.floor(ms / 3600000);
  const m = Math.floor((ms % 3600000) / 60000);
  const s = Math.floor((ms % 60000) / 1000);
  return `${h}h ${m}m ${s}s`;
}

// ================== SORTING ==================
function sortedBosses() {
  return [...bosses].sort((a, b) => {
    const ta = getRemaining(bossData[a.name]) ?? -1;
    const tb = getRemaining(bossData[b.name]) ?? -1;
    return ta - tb;
  });
}

// ================== UI ==================
function render() {
  const list = document.getElementById("bossList");
  list.innerHTML = "";

  sortedBosses().forEach(boss => {
    const remaining = getRemaining(bossData[boss.name]);
    let statusClass = "wait";

    if (remaining === null || remaining <= 0) statusClass = "spawned";
    else if (remaining < 3600000) statusClass = "soon";

    const div = document.createElement("div");
    div.className = "boss";

    div.innerHTML = `
      <strong>${boss.name}</strong> (Lv ${boss.level})<br>
      <em>${boss.location}</em><br>

      <div class="timer ${statusClass}">
        ${remaining === null ? "Not killed yet" : formatTime(remaining)}
      </div>

      ${isAdmin ? `
        <button onclick='markKilled(${JSON.stringify(boss)})'>Boss Killed</button>
        <button onclick='resetBoss("${boss.name}")'>Reset</button>
      ` : ""}
    `;

    list.appendChild(div);
  });
}

render();
setInterval(render, 1000);
</script>

</body>
</html>
