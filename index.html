<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Boss Respawn Timer</title>

<style>
body {
  font-family: Arial, sans-serif;
  background: #111;
  color: #eee;
  padding: 20px;
}

h1 {
  text-align: center;
}

.boss {
  background: #222;
  border-radius: 8px;
  padding: 15px;
  margin: 15px auto;
  max-width: 600px;
}

.timer {
  margin-top: 10px;
  font-weight: bold;
}

.spawned { color: #4caf50; }
.soon { color: #ffc107; }
.wait { color: #f44336; }

button {
  margin-top: 8px;
  margin-right: 5px;
  padding: 6px 10px;
  cursor: pointer;
}
</style>
</head>

<body>

<h1>Boss Respawn Timer</h1>
<div id="bossList"></div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
import {
  getFirestore,
  doc,
  setDoc,
  getDoc,
  onSnapshot
} from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

/* FIREBASE CONFIG â€” REPLACE WITH YOUR OWN */
const firebaseConfig = {
  apiKey: "AIzaSyBbINsazxCJkEHBwySyrQ4FLZhdHC85Cyw",
  authDomain: "boss-respawn-timer.firebaseapp.com",
  projectId: "boss-respawn-timer",
  storageBucket: "boss-respawn-timer.firebasestorage.app",
  messagingSenderId: "767083470052",
  appId: "1:767083470052:web:17d7453fe66700321760f1",
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

/* ================= ADMIN ================= */
const isAdmin = new URLSearchParams(window.location.search).get("admin") === "1";

/* ================= BOSSES ================= */
const bosses = [
  { name: "Venatus", level: 60, location: "Corrupted Basin", respawnHours: 10 },
  { name: "Viorent", level: 65, location: "Crescent Lake", respawnHours: 10 },
  { name: "Ego", level: 70, location: "Ulan Canyon", respawnHours: 21 },
  { name: "Livera", level: 75, location: "Protectors Ruins", respawnHours: 24 },
  { name: "Araneo", level: 75, location: "Lower Tomb of Tyriosa 1F", respawnHours: 24 },
  { name: "Undomiel", level: 80, location: "Secret Lab", respawnHours: 24 },
  { name: "Lady Dalia", level: 85, location: "Twilight Hill", respawnHours: 18 },
  { name: "General Aquleus", level: 85, location: "Lower Tomb of Tyriosa 2F", respawnHours: 29 },
  { name: "Amentis", level: 88, location: "Land of Glory", respawnHours: 29 },
  { name: "Baron Braudmore", level: 88, location: "Battlefield of Templar", respawnHours: 32 }
];

/* ================= DATA ================= */
let bossData = {};

/* ================= FIREBASE LISTENERS ================= */
function listenBoss(boss) {
  const ref = doc(db, "bosses", boss.name);
  onSnapshot(ref, snap => {
    if (snap.exists()) {
      bossData[boss.name] = snap.data();
    } else {
      setDoc(ref, { lastKill: 0, respawnMs: boss.respawnHours * 3600000 });
      bossData[boss.name] = { lastKill: 0, respawnMs: boss.respawnHours * 3600000 };
    }
    render();
  });
}

/* ================= ACTIONS ================= */
async function markKilled(bossName) {
  const boss = bosses.find(b => b.name === bossName);
  const ref = doc(db, "bosses", boss.name);
  const snap = await getDoc(ref);
  
  if (!snap.exists()) {
    await setDoc(ref, { lastKill: Date.now(), respawnMs: boss.respawnHours * 3600000 });
  } else {
    await setDoc(ref, { lastKill: Date.now(), respawnMs: boss.respawnHours * 3600000 }, { merge: true });
  }
}

async function resetBoss(bossName) {
  const ref = doc(db, "bosses", bossName);
  await setDoc(ref, { lastKill: 0, respawnMs: 0 }, { merge: true });
}

/* ================= TIMER ================= */
function remaining(boss) {
  const data = bossData[boss.name];
  if (!data || !data.lastKill) return null;
  return data.lastKill + data.respawnMs - Date.now();
}

function format(ms) {
  if (ms <= 0) return "SPAWNED / CHECK NOW";
  const h = Math.floor(ms / 3600000);
  const m = Math.floor((ms % 3600000) / 60000);
  const s = Math.floor((ms % 60000) / 1000);
  return `${h}h ${m}m ${s}s`;
}

/* ================= UI ================= */
function render() {
  const list = document.getElementById("bossList");
  list.innerHTML = "";

  // Create table
  const table = document.createElement("table");
  table.style.width = "100%";
  table.style.borderCollapse = "collapse";

  // Table header
  const header = document.createElement("tr");
  ["Name", "Status", "Respawn", "Countdown"].forEach(text => {
    const th = document.createElement("th");
    th.innerText = text;
    th.style.borderBottom = "1px solid #eee";
    th.style.padding = "8px";
    th.style.textAlign = "left";
    table.appendChild(th);
  });
  table.appendChild(header);

  // Table rows
  bosses.forEach(boss => {
    const r = remaining(boss);
    let status = "Waiting";
    let color = "wait";
    if (r === null || r <= 0) { status = "Spawned"; color = "spawned"; }
    else if (r < 3600000) { status = "Soon"; color = "soon"; }

    const tr = document.createElement("tr");

    // Name + level
    const tdName = document.createElement("td");
    tdName.innerText = `${boss.name} (Lv ${boss.level})\n${boss.location}`;
    tdName.style.padding = "8px";
    tr.appendChild(tdName);

    // Status
    const tdStatus = document.createElement("td");
    tdStatus.innerText = status;
    tdStatus.style.padding = "8px";
    tdStatus.style.color = color === "spawned" ? "#4caf50" : color === "soon" ? "#ffc107" : "#f44336";
    tr.appendChild(tdStatus);

    // Respawn (hours)
    const tdRespawn = document.createElement("td");
    tdRespawn.innerText = boss.respawnHours + "h";
    tdRespawn.style.padding = "8px";
    tr.appendChild(tdRespawn);

    // Countdown + buttons
    const tdCountdown = document.createElement("td");
    tdCountdown.style.padding = "8px";
    tdCountdown.innerHTML = r === null ? "Not killed yet" : format(r);
    if (isAdmin) {
      const killBtn = document.createElement("button");
      killBtn.innerText = "Boss Killed";
      killBtn.style.marginRight = "5px";
      killBtn.onclick = () => markKilled(boss.name);
      tdCountdown.appendChild(document.createElement("br"));
      tdCountdown.appendChild(killBtn);

      const resetBtn = document.createElement("button");
      resetBtn.innerText = "Reset";
      resetBtn.onclick = () => resetBoss(boss.name);
      tdCountdown.appendChild(resetBtn);
    }
    tr.appendChild(tdCountdown);

    table.appendChild(tr);
  });

  list.appendChild(table);
}

/* ================= START ================= */
bosses.forEach(listenBoss);
setInterval(render, 1000);
</script>



</body>
</html>




